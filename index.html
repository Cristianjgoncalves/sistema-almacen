<!DOCTYPE html><html><head><meta charset="UTF-8"><title>El Almacen del Repostero v107</title><script src="https://cdn.tailwindcss.com"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet"><style>body{font-family:'Inter',sans-serif;background:#f3f4f6;overflow:hidden}.btn-pago{border:2px solid #e5e7eb;border-radius:1rem;padding:10px;text-align:center;cursor:pointer;display:flex;flex-direction:column;align-items:center;justify-content:center}.active-efectivo{border-color:#22c55e;background:#f0fdf4}.active-fiado{border-color:#f59e0b;background:#fffbeb}</style></head><body class="h-screen flex" ondblclick="document.getElementById('buscador').focus()"><div id="login-screen" class="fixed inset-0 bg-blue-600 z-[200] flex items-center justify-center p-4"><div class="bg-white p-10 rounded-[3rem] shadow-2xl w-full max-w-md text-center"><h2 class="text-2xl font-black mb-6 text-blue-600 uppercase italic">EL ALMACEN DEL REPOSTERO</h2><input type="password" id="pass-login" placeholder="CONTRASEÃ‘A" class="w-full p-4 border-2 rounded-2xl mb-4 text-center font-black outline-none"><button onclick="intentarLogin()" class="w-full bg-blue-600 text-white py-5 rounded-[2rem] font-black uppercase shadow-xl">Ingresar</button></div></div><div id="sidebar" class="hidden w-64 bg-white shadow-xl flex flex-col z-20 border-r text-center"><div class="p-6 border-b"><h1 class="text-xl font-black text-blue-600 uppercase italic leading-tight">EL ALMACEN<br>DEL REPOSTERO</h1><p id="ui-local" class="text-[9px] font-bold text-gray-400 uppercase italic mt-1"></p></div><nav class="flex-1 px-4 py-4 space-y-1 overflow-y-auto font-black"><button onclick="showSection('pos')" class="w-full flex items-center p-3 hover:bg-blue-50 rounded-xl text-gray-600"><i class="fas fa-cash-register mr-3 text-blue-500"></i> Ventas</button><button onclick="showSection('pedidos')" class="w-full flex items-center p-3 hover:bg-blue-50 rounded-xl text-gray-600"><i class="fas fa-clipboard-list mr-3 text-purple-500"></i> Pedidos</button><button id="nav-inv" onclick="showSection('inventory')" class="hidden w-full flex items-center p-3 hover:bg-blue-50 rounded-xl text-gray-600"><i class="fas fa-boxes mr-3 text-blue-500"></i> Inventario</button><button id="nav-rep" onclick="showSection('reports')" class="hidden w-full flex items-center p-3 hover:bg-blue-50 rounded-xl text-gray-600"><i class="fas fa-file-invoice-dollar mr-3 text-blue-500"></i> Auditoria</button><button id="nav-gan" onclick="showSection('ganancias')" class="hidden w-full flex items-center p-3 hover:bg-green-50 rounded-xl text-gray-600"><i class="fas fa-hand-holding-usd mr-3 text-green-500"></i> Ganancias</button><button onclick="showSection('totals')" class="w-full flex items-center p-3 hover:bg-blue-50 rounded-xl text-gray-600"><i class="fas fa-chart-line mr-3 text-blue-500"></i> Totales Diarios</button><button onclick="showSection('accounts')" class="w-full flex items-center p-3 hover:bg-orange-50 rounded-xl text-orange-600"><i class="fas fa-user-clock mr-3"></i> Cta. Corriente</button><button onclick="showSection('weekly')" class="w-full flex items-center p-3 hover:bg-blue-50 rounded-xl text-gray-600"><i class="fas fa-list-ol mr-3 text-yellow-500"></i> Ranking</button><button onclick="showSection('config')" class="w-full flex items-center p-3 hover:bg-gray-50 rounded-xl text-gray-500"><i class="fas fa-cog mr-3"></i> Configuracion</button></nav><div class="p-4 border-t"><button onclick="location.reload()" class="text-[10px] font-black text-red-400 uppercase italic">Salir</button></div></div><div id="main-area" class="hidden flex-1 flex flex-col overflow-hidden text-center font-black"><header class="bg-white p-4 border-b flex justify-center"><input type="text" id="buscador" oninput="filtro=this.value.toLowerCase();renderVentas()" placeholder="BUSCAR PRODUCTO..." class="w-full max-w-lg p-3 border-2 rounded-2xl font-bold text-center bg-gray-50 outline-none uppercase"></header><main id="main-content" class="flex-1 p-6 overflow-y-auto text-center"></main></div><script>let productos=JSON.parse(localStorage.getItem('productos'))||[],historial=JSON.parse(localStorage.getItem('historial_ventas'))||[],gastos=JSON.parse(localStorage.getItem('gastos'))||[],cuentas=JSON.parse(localStorage.getItem('cuentas_corrientes'))||{},pedidos=JSON.parse(localStorage.getItem('pedidos_repostero'))||[],config=JSON.parse(localStorage.getItem('config_negocio'))||{nombre:"EL ALMACEN DEL REPOSTERO",tel:"",ig:"",fb:""},carrito=[],filtro="",met="Efectivo";function intentarLogin(){const p=document.getElementById('pass-login').value;if(p==="Mupirata1"||p==="12345"){if(p==="Mupirata1"){document.getElementById('nav-inv').classList.remove('hidden');document.getElementById('nav-rep').classList.remove('hidden');document.getElementById('nav-gan').classList.remove('hidden')}document.getElementById('login-screen').classList.add('hidden');document.getElementById('sidebar').classList.remove('hidden');document.getElementById('main-area').classList.remove('hidden');document.getElementById('ui-local').innerText=config.nombre;showSection('pos')}else alert("Error")}function showSection(s){const c=document.getElementById('main-content');if(s==='pos')renderPOS(c);else if(s==='inventory')renderInventory(c);else if(s==='reports')renderReports(c);else if(s==='accounts')renderAccounts(c);else if(s==='totals')renderTotals(c);else if(s==='ganancias')renderGanancias(c);else if(s==='weekly')renderWeekly(c);else if(s==='pedidos')renderPedidos(c);else if(s==='config')renderConfig(c)}function renderPOS(c){c.innerHTML=`<div class="flex gap-4 h-full"><div id="lista-v" class="flex-1 grid grid-cols-3 gap-3 content-start overflow-y-auto"></div><div class="w-80 bg-white p-6 rounded-3xl shadow-xl flex flex-col border font-black"><div id="cart" class="flex-1 overflow-y-auto space-y-2 mb-4"></div><input type="text" id="cli-f" placeholder="CLIENTE FIADO" class="hidden w-full p-2 border-2 border-orange-400 rounded-xl mb-4 text-center font-black uppercase"><div class="flex justify-between font-black text-3xl mb-4"><span>Total:</span><span id="t-txt">$0</span></div><div class="grid grid-cols-2 gap-2 mb-4"><div onclick="met='Efectivo';renderPOS(document.getElementById('main-content'))" class="btn-pago ${met==='Efectivo'?'active-efectivo':''} font-black text-xs uppercase">Efectivo</div><div onclick="met='Fiado';renderPOS(document.getElementById('main-content'))" class="btn-pago ${met==='Fiado'?'active-fiado':''} font-black text-xs uppercase">Fiado</div></div><button onclick="cobrar(true)" class="w-full bg-blue-600 text-white py-4 rounded-xl font-black uppercase mb-2 shadow-lg">Ticket</button><button onclick="cobrar(false)" class="w-full bg-gray-800 text-white py-4 rounded-xl font-black uppercase shadow-lg">Cobrar</button></div></div>`;if(met==='Fiado')document.getElementById('cli-f').classList.remove('hidden');renderVentas();updateCart()}function renderVentas(){const f=productos.filter(p=>p.nombre.toLowerCase().includes(filtro));document.getElementById('lista-v').innerHTML=f.map(p=>`<div onclick="addCar(${p.id})" class="bg-white p-3 rounded-2xl border-2 hover:border-blue-400 cursor-pointer text-center shadow-sm"><h3 class="font-black text-xs uppercase truncate">${p.nombre}</h3><p class="text-lg font-black">$${p.precio}</p></div>`).join('')}function addCar(id){const p=productos.find(x=>x.id===id);const e=carrito.find(x=>x.id===id);if(e)e.cant++;else carrito.push({...p,cant:1});updateCart()}function updateCart(){document.getElementById('cart').innerHTML=carrito.map((i,idx)=>`<div class="flex justify-between items-center bg-gray-50 p-2 rounded-lg text-[10px] font-black uppercase"><span class="truncate w-24">${i.nombre}</span><input type="number" step="0.001" value="${i.cant}" onchange="carrito[${idx}].cant=parseFloat(this.value);updateCart()" class="w-12 border text-center rounded"><button onclick="carrito.splice(${idx},1);updateCart()" class="text-red-500 px-2 font-black">X</button></div>`).join('');let total=carrito.reduce((s,i)=>s+(i.precio*i.cant),0);document.getElementById('t-txt').innerText="$"+total.toFixed(2)}function cobrar(imp){if(!carrito.length)return;let total=carrito.reduce((s,i)=>s+(i.precio*i.cant),0),gana=carrito.reduce((s,i)=>s+((i.precio-(i.costo||0))*i.cant),0),cli="";if(met==='Fiado'){cli=document.getElementById('cli-f').value.toUpperCase();if(!cli){alert("NOMBRE FIADO");return}cuentas[cli]=(cuentas[cli]||0)+total;localStorage.setItem('cuentas_corrientes',JSON.stringify(cuentas))}historial.push({id:Date.now(),fecha:new Date().toLocaleDateString(),hora:new Date().toLocaleTimeString(),total,ganancia:gana,met,cliente:cli,items:[...carrito]});localStorage.setItem('historial_ventas',JSON.stringify(historial));if(imp){const w=window.open('','_blank');w.document.write(`<html><body style="width:230px;text-align:center;font-family:sans-serif;"><b>${config.nombre}</b><hr>${carrito.map(i=>`<div style="font-size:10px;display:flex;justify-content:space-between;"><span>${i.cant}x ${i.nombre}</span><span>$${(i.precio*i.cant).toFixed(2)}</span></div>`).join('')}<hr><b>TOTAL: $${total.toFixed(2)}</b><br><span style="font-size:9px;">${met} ${cli}</span><hr><div style="font-size:8px;">${config.tel?'Tel:'+config.tel:''}<br>${config.ig?'IG:'+config.ig:''}<br>${config.fb?'FB:'+config.fb:''}</div><script>window.print();window.close();<\/script></body></html>`)}carrito=[];met="Efectivo";showSection('pos')}function renderInventory(c){c.innerHTML=`<div class="bg-white p-6 rounded-3xl border mb-6 font-black"><h2>NUEVO PRODUCTO</h2><div class="grid grid-cols-4 gap-2"><input type="text" id="in" placeholder="NOMBRE" class="border p-3 rounded uppercase"><input type="number" id="ic" placeholder="COSTO" class="border p-3 rounded"><input type="number" id="ip" placeholder="VENTA" class="border p-3 rounded"><button onclick="saveP()" class="bg-blue-600 text-white rounded font-black">GUARDAR</button></div></div><div id="l-inv" class="space-y-2"></div>`;renderInvList()}function renderInvList(){document.getElementById('l-inv').innerHTML=productos.map((p,idx)=>`<div class="bg-white p-4 rounded-xl border flex justify-between font-black uppercase text-xs items-center"><span>${p.nombre}</span><div class="flex gap-4 items-center"><span>C:$${p.costo||0}</span><input type="number" value="${p.precio}" onchange="productos[${idx}].precio=parseFloat(this.value);localStorage.setItem('productos',JSON.stringify(productos))" class="w-20 border rounded p-1 text-center font-black"></div></div>`).join('')}function saveP(){let n=document.getElementById('in').value,c=document.getElementById('ic').value,p=document.getElementById('ip').value;if(n&&p){productos.push({id:Date.now(),nombre:n.toUpperCase(),costo:parseFloat(c||0),precio:parseFloat(p)});localStorage.setItem('productos',JSON.stringify(productos));renderInvList()}}function renderAccounts(c){c.innerHTML=`<h2 class="text-2xl font-black text-orange-600 mb-6 text-center uppercase">CUENTAS CORRIENTES</h2><div id="pago-form" class="hidden mb-6 bg-blue-50 p-6 rounded-2xl border-2 border-blue-200"><input type="number" id="m-pago" placeholder="MONTO $" class="p-2 rounded border w-full mb-2 text-center font-black"><button onclick="confPago()" class="bg-blue-600 text-white w-full py-2 rounded font-black">CONFIRMAR ENTREGA</button></div><div class="grid grid-cols-2 gap-4">${Object.entries(cuentas).map(([n,d])=>d>0?`<div class="bg-white p-6 rounded-3xl border shadow-sm text-center font-black"><h3 class="uppercase text-blue-900">${n}</h3><p class="text-3xl text-red-600 my-2">$${d.toFixed(2)}</p><button onclick="document.getElementById('pago-form').classList.remove('hidden');window.cliP='${n}'" class="bg-green-500 text-white px-4 py-2 rounded-xl text-xs uppercase">ENTREGA PAGO</button></div>`:'').join('')}</div>`}function confPago(){let m=parseFloat(document.getElementById('m-pago').value),n=window.cliP;if(!isNaN(m)){historial.push({id:Date.now(),fecha:new Date().toLocaleDateString(),hora:new Date().toLocaleTimeString(),total:m,ganancia:m,met:'Efectivo',cliente:n+' (PAGO)'});cuentas[n]-=m;localStorage.setItem('cuentas_corrientes',JSON.stringify(cuentas));localStorage.setItem('historial_ventas',JSON.stringify(historial));showSection('accounts')}}function renderTotals(c){const f=new Date().toLocaleDateString(),vH=historial.filter(v=>v.fecha===f&&!v.cliente.includes('(PAGO)')).reduce((s,v)=>s+v.total,0),pH=historial.filter(v=>v.fecha===f&&v.cliente.includes('(PAGO)')).reduce((s,v)=>s+v.total,0),gH=gastos.filter(g=>g.fecha===f).reduce((s,g)=>s+g.monto,0);c.innerHTML=`<h2 class="text-2xl font-black text-blue-600 mb-6 uppercase text-center">TOTALES DIARIOS</h2><div class="grid grid-cols-2 gap-4 mb-6"><div class="bg-white p-6 rounded-3xl border shadow-xl">Ventas: <p class="text-2xl text-blue-600">$${vH.toFixed(2)}</p></div><div class="bg-white p-6 rounded-3xl border shadow-xl">Entregas: <p class="text-2xl text-green-600">$${pH.toFixed(2)}</p></div><div class="bg-white p-6 rounded-3xl border shadow-xl col-span-2">Gastos: <p class="text-2xl text-red-500">$${gH.toFixed(2)}</p><button onclick="addGasto()" class="text-xs text-blue-500 underline">+ CARGAR GASTO</button></div></div><h3 class="font-black text-green-600 text-4xl">CAJA: $${(vH+pH-gH).toFixed(2)}</h3>`}function addGasto(){let d=prompt("CONCEPTO"),m=prompt("MONTO");if(d&&m){gastos.push({fecha:new Date().toLocaleDateString(),desc:d.toUpperCase(),monto:parseFloat(m)});localStorage.setItem('gastos',JSON.stringify(gastos));showSection('totals')}}function renderGanancias(c){const f=new Date().toLocaleDateString(),gH=historial.filter(v=>v.fecha===f).reduce((s,v)=>s+v.ganancia,0);c.innerHTML=`<h2 class="text-2xl font-black text-green-600 mb-6 uppercase text-center">GANANCIAS</h2><div class="bg-white p-10 rounded-[3rem] border shadow-xl text-center"><p class="text-gray-400 uppercase text-xs">Hoy</p><p class="text-6xl text-green-600">$${gH.toFixed(2)}</p></div>`}function renderReports(c){const h=historial.filter(v=>v.fecha===new Date().toLocaleDateString());c.innerHTML=`<h2 class="text-2xl font-black text-blue-600 mb-6 text-center">AUDITORIA HOY</h2><div class="space-y-2">${h.slice().reverse().map(v=>`<div class="bg-white p-4 rounded-xl border flex justify-between items-center font-black text-xs"><span>${v.hora} ${v.met} ${v.cliente}</span><div><b>$${v.total.toFixed(2)}</b><button onclick="borrarV(${v.id})" class="ml-4 text-red-300">X</button></div></div>`).join('')}</div>`}function borrarV(id){if(confirm("Anular?")){historial=historial.filter(v=>v.id!==id);localStorage.setItem('historial_ventas',JSON.stringify(historial));showSection('reports')}}function renderWeekly(c){const a=historial.reduce((acc,v)=>{if(!acc[v.fecha])acc[v.fecha]={};if(v.items){v.items.forEach(i=>{if(!acc[v.fecha][i.nombre])acc[v.fecha][i.nombre]=0;acc[v.fecha][i.nombre]+=i.cant})}return acc},{});const fs=Object.keys(a).sort((x,y)=>new Date(y)-new Date(x)).slice(0,7);c.innerHTML=`<h2 class="text-3xl font-black mb-8 uppercase text-center">Ranking</h2><div class="space-y-4">${fs.map(f=>`<div class="bg-white p-6 rounded-2xl border"><h3>${f}</h3>${Object.entries(a[f]).sort((x,y)=>y[1]-x[1]).map(([n,q])=>`<div class="flex justify-between text-xs border-b"><span>${n}</span><span>${q}</span></div>`).join('')}</div>`).join('')}</div>`}function renderPedidos(c){c.innerHTML=`<div class="bg-white p-10 rounded-3xl border mb-6"><h2 class="text-center mb-4">PEDIDOS</h2><div class="grid grid-cols-2 gap-2"><input id="pc" placeholder="CLIENTE" class="border p-2 rounded uppercase"><input id="pf" type="date" class="border p-2 rounded"></div><textarea id="pd" placeholder="DETALLE" class="w-full border p-2 rounded mt-2 uppercase"></textarea><button onclick="sPed()" class="bg-blue-600 text-white w-full py-3 rounded mt-2 font-black">GUARDAR PEDIDO</button></div><div id="l-ped" class="space-y-2"></div>`;renderPL()}function renderPL(){document.getElementById('l-ped').innerHTML=pedidos.map((p,idx)=>`<div class="bg-white p-4 rounded-xl border flex justify-between items-center"><div><p class="text-xs text-purple-500 font-black">${p.fecha}</p><p class="font-black">${p.cliente}</p><p class="text-xs">${p.detalle}</p></div><button onclick="pedidos.splice(${idx},1);localStorage.setItem('pedidos_repostero',JSON.stringify(pedidos));renderPL()" class="text-green-500 text-2xl font-black">OK</button></div>`).join('')}function sPed(){let c=document.getElementById('pc').value,f=document.getElementById('pf').value,d=document.getElementById('pd').value;if(c&&f&&d){pedidos.push({cliente:c.toUpperCase(),fecha:f,detalle:d.toUpperCase()});localStorage.setItem('pedidos_repostero',JSON.stringify(pedidos));renderPL()}}function renderConfig(c){c.innerHTML=`<div class="bg-white p-10 rounded-3xl border max-w-md mx-auto text-center font-black"><h2>CONFIGURACION</h2><input id="cn" value="${config.nombre}" class="w-full border p-3 rounded mb-2 uppercase text-center"><input id="ct" placeholder="TEL" value="${config.tel}" class="w-full border p-3 rounded mb-2 text-center"><input id="ci" placeholder="IG" value="${config.ig}" class="w-full border p-3 rounded mb-2 text-center"><input id="cf" placeholder="FB" value="${config.fb}" class="w-full border p-3 rounded mb-4 text-center"><button onclick="saveC()" class="bg-blue-600 text-white w-full py-4 rounded-xl font-black">GUARDAR</button></div>`}function saveC(){config.nombre=document.getElementById('cn').value.toUpperCase();config.tel=document.getElementById('ct').value;config.ig=document.getElementById('ci').value;config.fb=document.getElementById('cf').value;localStorage.setItem('config_negocio',JSON.stringify(config));location.reload()}</script></body></html>
